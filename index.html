<!DOCTYPE html>
<html>
<head>
    <title>Newly Created Tokens on Ethereum</title>
</head>
<body>
    <h1>Newly Created Tokens on Ethereum</h1>
    <div id="tokenList"></div>

    <script>
        // Replace with your Etherscan API key
        const etherscanApiKey = 'AFFD2SXUNV3RY968V4442KMBP4928IBMJ7';
        // Replace with your MythX API key
        const mythxApiKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyNWVlMzgzZS01NWUxLTQ1ZGEtYjExZC0wNTYwMDkzNmY3YjAiLCJpYXQiOjE2OTAwNTk0MzEuOTg1LCJpc3MiOiJNeXRoWCBBdXRoIFNlcnZpY2UiLCJleHAiOjIwMDU2MzU0MzEuOTcsInVzZXJJZCI6IjY0YmM0MjhlODI4OGFiNzdhOGEwNmI2NyJ9.VKLkGAEJxa3eLR_S_EIBTBvoZyiU2G9M17S1Yq5CPH4';

        async function fetchTokenSourceCode(contractAddress) {
            try {
                const response = await fetch(`https://api.etherscan.io/api?module=contract&action=getsourcecode&address=${contractAddress}&apikey=${etherscanApiKey}`);
                const data = await response.json();

                if (data.status === '1' && data.result.length > 0) {
                    return data.result[0].SourceCode;
                } else {
                    console.error('Error fetching contract source code:', data.message);
                    return null;
                }
            } catch (error) {
                console.error('Error fetching contract source code:', error);
                return null;
            }
        }

        async function fetchMythXAnalysis(code) {
            try {
                const mythxApiUrl = 'https://api.mythx.io/v1/analyses';

                const analysisRequest = {
                    sources: {
                        'contract.sol': {
                            content: code
                        }
                    }
                };

                const response = await fetch(mythxApiUrl, {
                    method: 'POST',
                    headers: {
                        Authorization: `Bearer ${mythxApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(analysisRequest)
                });

                const analysisData = await response.json();
                return analysisData;
            } catch (error) {
                console.error('Error analyzing contract:', error);
                return null;
            }
        }

        async function fetchNewTokens() {
            try {
                const response = await fetch(`https://api.etherscan.io/api?module=account&action=tokentx&address=0x0000000000000000000000000000000000000000&startblock=0&endblock=999999999&sort=desc&apikey=${etherscanApiKey}`);
                const data = await response.json();

                if (data.status === '1') {
                    const tokenList = document.getElementById('tokenList');

                    if (data.result && data.result.length > 0) {
                        for (const tokenTx of data.result) {
                            const contractAddress = tokenTx.contractAddress;
                            const tokenInfo = `
                                <div>
                                    <strong>Token Name:</strong> ${tokenTx.tokenName}<br>
                                    <strong>Token Symbol:</strong> ${tokenTx.tokenSymbol}<br>
                                    <strong>Token Contract Address:</strong> ${contractAddress}<br>
                                    <strong>Transaction Hash:</strong> ${tokenTx.hash}<br>
                                    <strong>Contract Source Code:</strong><br>
                                    <textarea rows="10" cols="80">${await fetchTokenSourceCode(contractAddress)}</textarea><br>
                                    <button onclick="analyzeContract('${contractAddress}')">Analyze Contract</button><br>
                                    <div id="analysisResult_${contractAddress}"></div>
                                </div>
                            `;
                            tokenList.insertAdjacentHTML('beforeend', tokenInfo);
                        }
                    } else {
                        tokenList.innerHTML = '<p>No newly created tokens found.</p>';
                    }
                } else {
                    console.error('Error fetching token data:', data.message);
                }
            } catch (error) {
                console.error('Error fetching token data:', error);
            }
        }

        async function analyzeContract(contractAddress) {
            const sourceCode = await fetchTokenSourceCode(contractAddress);
            if (sourceCode) {
                const analysisData = await fetchMythXAnalysis(sourceCode);
                if (analysisData) {
                    const analysisResultDiv = document.getElementById(`analysisResult_${contractAddress}`);
                    analysisResultDiv.innerHTML = `<pre>${JSON.stringify(analysisData, null, 2)}</pre>`;
                }
            }
        }

        fetchNewTokens();
    </script>
</body>
</html>
